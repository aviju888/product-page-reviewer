<!doctype html>
<html>
<head>
  <title>Product Page Reviewer</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>Product Page Reviewer</h1>

    <form id="form" method="post" action="/api/analyze">
      <input type="url" name="url" placeholder="https://example.com/product/123" required />
      <button type="submit" id="analyzeBtn">Analyze</button>
    </form>

    <div id="loading" class="card" style="display:none;">
      <div class="spinner" aria-hidden="true"></div>
      <p role="status">Analyzing page...</p>
    </div>

    <!-- Tabs -->
    <div id="app" style="display:none;">
      <div class="tabs">
        <button class="tab active" data-tab="overview">Overview</button>
        <button class="tab" data-tab="details">Details</button>
        <button class="tab" data-tab="raw">Raw</button>
      </div>

      <!-- OVERVIEW -->
      <section id="tab-overview" class="tabpanel active">
        <div class="grid kpi-grid">
          <div class="kpi">
            <div class="kpi-label">Overall</div>
            <div class="kpi-value" id="kpi-overall">‚Äî</div>
            <div class="kpi-sub" id="kpi-summary">Waiting‚Ä¶</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">CTA</div>
            <div class="kpi-value" id="kpi-cta">‚Äî</div>
            <div class="kpi-sub" id="kpi-cta-sub">‚Äî</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Trust</div>
            <div class="kpi-value" id="kpi-trust">‚Äî</div>
            <div class="kpi-sub" id="kpi-trust-sub">‚Äî</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Performance</div>
            <div class="kpi-value" id="kpi-perf">‚Äî</div>
            <div class="kpi-sub" id="kpi-perf-sub">‚Äî</div>
          </div>
        </div>

        <div class="card">
          <h2>üö® Top Issues</h2>
          <ul id="overview-issues" class="list"></ul>
        </div>

        <div class="card">
          <h2>‚úÖ Strengths</h2>
          <ul id="overview-strengths" class="list"></ul>
        </div>

        <div class="card">
          <h2>üéØ Prioritized Actions</h2>
          <div id="overview-actions" class="list-actions"></div>
        </div>
      </section>

      <!-- DETAILS (Accordion sections) -->
      <section id="tab-details" class="tabpanel">
        <details class="accordion" open>
          <summary>AI Analysis</summary>
          <div class="summary-card">
            <p id="summary">LLM analysis not available</p>
          </div>
          <div class="scores-grid" id="category-scores"></div>
          <div class="cols">
            <div>
              <h3>üö® Critical Issues</h3>
              <ul id="top-issues" class="list"></ul>
            </div>
            <div>
              <h3>‚ö° Quick Wins</h3>
              <ul id="quick-wins" class="list"></ul>
            </div>
          </div>
          <div>
            <h3>‚úÖ What's Working Well</h3>
            <ul id="detailed-strengths" class="list"></ul>
          </div>
          <div>
            <h3>üéØ Prioritized Actions</h3>
            <div id="prioritized-actions" class="list-actions"></div>
          </div>
          <div class="copy-suggestions" id="copy-suggestions" style="display:none;">
            <h3>‚úçÔ∏è Copy Suggestions</h3>
            <div id="copy-content"></div>
          </div>
        </details>

        <details class="accordion">
          <summary>üìä Core Metrics</summary>
          <div class="grid metrics-grid">
            <div class="metric-card essential"><h3>Page Title</h3><p id="page-title">-</p></div>
            <div class="metric-card essential"><h3>H1 Heading</h3><p id="h1-heading">-</p></div>
            <div class="metric-card essential"><h3>Price</h3><p id="price">-</p></div>
            <div class="metric-card essential"><h3>CTA</h3><p id="cta">-</p></div>
            <div class="metric-card"><h3>Price Near CTA</h3><p id="price-near-cta">-</p></div>
            <div class="metric-card"><h3>CTA Above Fold</h3><p id="cta-above-fold">-</p></div>
            <div class="metric-card"><h3>Shipping Info Near CTA</h3><p id="shipping-near-cta">-</p></div>
          </div>
        </details>

        <details class="accordion">
          <summary>üñºÔ∏è Visual & Content</summary>
          <div class="grid metrics-grid">
            <div class="metric-card"><h3>Images</h3><p id="image-count">-</p></div>
            <div class="metric-card"><h3>Alt Coverage</h3><p id="alt-coverage">-</p></div>
            <div class="metric-card"><h3>Missing Alt</h3><p id="missing-alt">-</p></div>
            <div class="metric-card"><h3>Gallery Present</h3><p id="gallery-present">-</p></div>
            <div class="metric-card"><h3>H1 Count</h3><p id="h1-count">-</p></div>
            <div class="metric-card"><h3>Has Subheadings</h3><p id="has-subheadings">-</p></div>
            <div class="metric-card"><h3>Max DOM Depth</h3><p id="max-dom-depth">-</p></div>
            <div class="metric-card"><h3>Section Count</h3><p id="section-count">-</p></div>
          </div>
        </details>

        <details class="accordion">
          <summary>üõ°Ô∏è Trust & Social Proof</summary>
          <div class="grid metrics-grid">
            <div class="metric-card"><h3>Reviews/Ratings</h3><p id="has-reviews">-</p></div>
            <div class="metric-card"><h3>Testimonials</h3><p id="testimonials">-</p></div>
            <div class="metric-card"><h3>Average Rating</h3><p id="average-rating">-</p></div>
            <div class="metric-card"><h3>Security Badges</h3><p id="security-badges">-</p></div>
            <div class="metric-card"><h3>Guarantees</h3><p id="guarantees">-</p></div>
            <div class="metric-card"><h3>Trust Text Hits</h3><p id="trust-text-hits">-</p></div>
          </div>
        </details>

        <details class="accordion">
          <summary>‚öôÔ∏è Technical & SEO</summary>
          <div class="grid metrics-grid">
            <div class="metric-card"><h3>Viewport Present</h3><p id="viewport-present">-</p></div>
            <div class="metric-card"><h3>Meta Title Length</h3><p id="meta-title-len">-</p></div>
            <div class="metric-card"><h3>Meta Description Length</h3><p id="meta-desc-len">-</p></div>
            <div class="metric-card"><h3>OG Tags</h3><p id="og-tags">-</p></div>
            <div class="metric-card"><h3>Canonical URL</h3><p id="canonical">-</p></div>
            <div class="metric-card"><h3>Breadcrumbs</h3><p id="breadcrumbs">-</p></div>
            <div class="metric-card"><h3>Related Products</h3><p id="related-products">-</p></div>
            <div class="metric-card"><h3>Search Function</h3><p id="has-search">-</p></div>
          </div>
        </details>

        <details class="accordion">
          <summary>üöÄ Performance & Accessibility</summary>
          <div class="grid metrics-grid">
            <div class="metric-card"><h3>HTML Size</h3><p id="html-bytes">-</p></div>
            <div class="metric-card"><h3>External Scripts</h3><p id="external-scripts">-</p></div>
            <div class="metric-card"><h3>Inline Scripts</h3><p id="inline-scripts">-</p></div>
            <div class="metric-card"><h3>Unlabeled Buttons</h3><p id="unlabeled-buttons">-</p></div>
            <div class="metric-card"><h3>Unlabeled Links</h3><p id="unlabeled-links">-</p></div>
            <div class="metric-card"><h3>Forms</h3><p id="form-count">-</p></div>
            <div class="metric-card"><h3>Form Fields</h3><p id="form-fields">-</p></div>
            <div class="metric-card"><h3>Popups</h3><p id="popup-count">-</p></div>
          </div>
        </details>

        <details class="accordion">
          <summary>üèóÔ∏è Structural Analysis</summary>
          <div class="grid structural-grid">
            <div>
              <h3>Heading Hierarchy</h3>
              <div id="heading-hierarchy" class="stack"></div>
            </div>
            <div class="grid structural-metrics">
              <div class="metric-card"><h3>Main Element</h3><p id="main-present">-</p></div>
              <div class="metric-card"><h3>CTA Grouping</h3><p id="cta-grouping">-</p></div>
              <div class="metric-card"><h3>CTA Position</h3><p id="cta-position">-</p></div>
              <div class="metric-card"><h3>Modals with CTA</h3><p id="modals-with-cta">-</p></div>
            </div>
          </div>
        </details>
      </section>

      <!-- RAW -->
      <section id="tab-raw" class="tabpanel">
        <div class="card">
          <button id="toggle-raw" class="button" type="button">Show Raw Data</button>
          <pre id="raw-data" style="display:none;"></pre>
        </div>
      </section>
    </div>
  </div>

  <script>
    const form = document.getElementById("form");
    const app = document.getElementById("app");
    const loading = document.getElementById("loading");
    const analyzeBtn = document.getElementById("analyzeBtn");
    const toggleRawBtn = document.getElementById("toggle-raw");
    const rawData = document.getElementById("raw-data");
    let currentData = null;

    // Tabs
    document.addEventListener('click', (e) => {
      const tab = e.target.closest('.tab');
      if (!tab) return;
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tabpanel').forEach(p => p.classList.remove('active'));
      tab.classList.add('active');
      document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      loading.style.display = "block";
      app.style.display = "none";
      analyzeBtn.disabled = true;
      analyzeBtn.textContent = "Analyzing...";
      try {
        const url = form.url.value;
        const res = await fetch("/api/analyze", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ url })
        });
        const data = await res.json();
        currentData = data;
        populateDashboard(data);
        app.style.display = "block";
        // Default to Overview tab
        document.querySelector('.tab[data-tab="overview"]').click();
      } catch (err) {
        alert(`Error: ${err.message}`);
      } finally {
        loading.style.display = "none";
        analyzeBtn.disabled = false;
        analyzeBtn.textContent = "Analyze";
      }
    });

    if (toggleRawBtn) {
      toggleRawBtn.addEventListener("click", () => {
        const show = rawData.style.display === "none";
        rawData.style.display = show ? "block" : "none";
        toggleRawBtn.textContent = show ? "Hide Raw Data" : "Show Raw Data";
        if (show && currentData) rawData.textContent = JSON.stringify(currentData, null, 2);
      });
    }

    function pill(n) {
      if (n == null || isNaN(n)) return '‚Äî';
      const s = Number(n);
      const cls = s >= 7 ? 'good' : s >= 4 ? 'warn' : 'bad';
      return `<span class="pill ${cls}">${s}/10</span>`;
    }

    function populateDashboard(data) {
      const h = data.heuristics || {};
      const llm = data.llm_report && data.llm_report !== "LLM not configured"
        ? (typeof data.llm_report === 'string' ? JSON.parse(data.llm_report) : data.llm_report)
        : null;

      // ----- OVERVIEW KPIs -----
      const scores = llm?.category_scores || {};
      const conversionScores = h.conversion_scores || {};
      
      // Use backend's calculated overall score, or fallback to LLM scores with correct mapping
      let overall = conversionScores.overall_score;
      if (!overall && llm?.category_scores) {
        // Map LLM category scores to backend field names
        const llmScores = {
          clarity: scores.clarity ?? scores.value_proposition_clarity ?? 0,
          cta: scores.cta ?? scores.cta_effectiveness ?? 0,
          trust: scores.trust ?? scores.trust_social_proof ?? 0,
          imagery: scores.imagery ?? scores.visual_imagery ?? 0,
          performance: scores.performance ?? scores.technical_performance ?? 0
        };
        overall = Math.round((
          llmScores.clarity + llmScores.cta + llmScores.trust + 
          llmScores.imagery + llmScores.performance
        ) / 5);
      }

      document.getElementById('kpi-overall').innerHTML = pill(isFinite(overall) ? overall : 0);
      document.getElementById('kpi-summary').textContent = llm?.summary || "Heuristic-only results shown below.";

      document.getElementById('kpi-cta').innerHTML = pill(
        scores.cta ?? scores.cta_effectiveness ?? conversionScores.cta_effectiveness ?? (h.price_near_cta && h.cta ? 7 : 4)
      );
      document.getElementById('kpi-cta-sub').textContent =
        (h.cta ? "CTA found" : "CTA missing") + (h.price_near_cta ? " ¬∑ price nearby" : " ¬∑ price not near CTA");

      document.getElementById('kpi-trust').innerHTML = pill(
        scores.trust ?? scores.trust_social_proof ?? conversionScores.trust_social_proof ?? (h.has_reviews_or_ratings ? 7 : 3)
      );
      document.getElementById('kpi-trust-sub').textContent =
        (h.has_reviews_or_ratings ? "Reviews present" : "No reviews visible") + (h.guarantees ? " ¬∑ guarantees" : "");

      document.getElementById('kpi-perf').innerHTML = pill(
        scores.performance ?? scores.technical_performance ?? conversionScores.technical_performance ?? (h.external_script_count > 10 ? 3 : 7)
      );
      document.getElementById('kpi-perf-sub').textContent =
        `${(h.html_bytes || 0).toLocaleString()} bytes ¬∑ ${h.external_script_count||0} external JS`;

      // Top issues & actions for overview
      const topIssues = llm?.top_issues || [];
      const issuesEl = document.getElementById("overview-issues"); issuesEl.innerHTML = "";
      (topIssues.slice(0,5)).forEach(i => { const li = document.createElement('li'); li.textContent = i; issuesEl.appendChild(li); });

      // Identify strengths based on heuristics
      const strengths = [];
      
      // CTA strengths
      if (h.cta) strengths.push("Clear call-to-action found");
      if (h.price_near_cta) strengths.push("Price positioned near CTA");
      if (h.cta_above_fold) strengths.push("CTA appears above the fold");
      if (h.shipping_returns_near_cta) strengths.push("Shipping/return info near CTA");
      
      // Trust & social proof strengths
      if (h.has_reviews_or_ratings) strengths.push("Customer reviews/ratings present");
      if (h.average_rating && h.average_rating >= 4.0) strengths.push(`High average rating (${h.average_rating.toFixed(1)}/5)`);
      if (h.testimonials > 0) strengths.push(`${h.testimonials} customer testimonials`);
      if (h.security_badges > 0) strengths.push("Security badges displayed");
      if (h.guarantees > 0) strengths.push("Guarantee/warranty information");
      
      // Content & structure strengths
      if (h.h1) strengths.push("Clear H1 heading present");
      if (h.title && h.title.length > 10) strengths.push("Descriptive page title");
      if (h.price) strengths.push("Price clearly displayed");
      if (h.has_subheadings) strengths.push("Well-structured with subheadings");
      if (h.main_present) strengths.push("Semantic <main> element used");
      
      // Visual strengths
      if (h.image_count > 0) strengths.push(`${h.image_count} product images`);
      if (h.alt_coverage && h.alt_coverage >= 0.8) strengths.push(`Good alt text coverage (${(h.alt_coverage * 100).toFixed(0)}%)`);
      if (h.gallery_present) strengths.push("Product image gallery present");
      
      // Technical strengths
      if (h.viewport_present) strengths.push("Mobile viewport configured");
      if (h.og_tags_present) strengths.push("Open Graph tags for social sharing");
      if (h.canonical_present) strengths.push("Canonical URL specified");
      if (h.breadcrumbs_present) strengths.push("Breadcrumb navigation");
      if (h.related_products_present) strengths.push("Related products section");
      if (h.has_search) strengths.push("Site search functionality");
      
      // Performance strengths
      if (h.html_bytes && h.html_bytes < 500000) strengths.push("Reasonable page size");
      if (h.external_script_count && h.external_script_count < 10) strengths.push("Minimal external scripts");
      if (h.a11y_unlabeled_buttons === 0) strengths.push("All buttons properly labeled");
      if (h.a11y_unlabeled_links === 0) strengths.push("All links properly labeled");
      
      // Display strengths (top 6)
      const strengthsEl = document.getElementById("overview-strengths"); 
      strengthsEl.innerHTML = "";
      strengths.slice(0,6).forEach(s => { 
        const li = document.createElement('li'); 
        li.textContent = s; 
        li.style.borderLeftColor = 'var(--good)';
        li.style.borderLeftWidth = '3px';
        strengthsEl.appendChild(li); 
      });

      const actions = llm?.prioritized_actions || [];
      const actionsEl = document.getElementById("overview-actions"); actionsEl.innerHTML = "";
      actions.slice(0,5).forEach(a => {
        const div = document.createElement('div');
        const impact = a.impact ?? 2, effort = a.effort ?? 2, conf = a.confidence ?? 2;
        div.className = "action-item";
        div.innerHTML = `
          <h4>${a.action || "Action"}</h4>
          <p><strong>Why:</strong> ${a.why || "‚Äî"}</p>
          <div class="action-metrics">
            <span class="metric impact ${impact>=3?'high':impact>=2?'medium':'low'}">Impact: ${impact}/3</span>
            <span class="metric effort ${effort<=1?'easy':effort<=2?'medium':'hard'}">Effort: ${effort}/3</span>
            <span class="metric confidence">Confidence: ${conf}/3</span>
          </div>`;
        actionsEl.appendChild(div);
      });

      // ----- DETAILS -----
      // Core Metrics
      document.getElementById("page-title").textContent = h.title || "Not found";
      document.getElementById("h1-heading").textContent = h.h1 || "Not found";
      document.getElementById("price").textContent = h.price || "Not found";
      document.getElementById("cta").textContent = h.cta || "Not found";
      document.getElementById("price-near-cta").textContent = h.price_near_cta ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("cta-above-fold").textContent = h.cta_above_fold ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("shipping-near-cta").textContent = h.shipping_returns_near_cta ? "‚úÖ Yes" : "‚ùå No";

      // Visual & Content
      document.getElementById("image-count").textContent = h.image_count || "0";
      document.getElementById("alt-coverage").textContent = h.alt_coverage ? `${(h.alt_coverage * 100).toFixed(0)}%` : "0%";
      document.getElementById("missing-alt").textContent = h.images_missing_alt || "0";
      document.getElementById("gallery-present").textContent = h.gallery_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("h1-count").textContent = h.h1_count || "0";
      document.getElementById("has-subheadings").textContent = h.has_subheadings ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("max-dom-depth").textContent = h.max_dom_depth || "0";
      document.getElementById("section-count").textContent = h.section_count || "0";

      // Trust & Social Proof
      document.getElementById("has-reviews").textContent = h.has_reviews_or_ratings ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("testimonials").textContent = h.testimonials || "0";
      document.getElementById("average-rating").textContent = h.average_rating ? Number(h.average_rating).toFixed(1) : "N/A";
      document.getElementById("security-badges").textContent = h.security_badges || "0";
      document.getElementById("guarantees").textContent = h.guarantees || "0";
      document.getElementById("trust-text-hits").textContent = h.trust_text_hits || "0";

      // Technical & SEO
      document.getElementById("viewport-present").textContent = h.viewport_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("meta-title-len").textContent = h.meta_title_len || "0";
      document.getElementById("meta-desc-len").textContent = h.meta_description_len || "0";
      document.getElementById("og-tags").textContent = h.og_tags_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("canonical").textContent = h.canonical_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("breadcrumbs").textContent = h.breadcrumbs_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("related-products").textContent = h.related_products_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("has-search").textContent = h.has_search ? "‚úÖ Yes" : "‚ùå No";

      // Performance & A11y
      document.getElementById("html-bytes").textContent = h.html_bytes ? h.html_bytes.toLocaleString() : "0";
      document.getElementById("external-scripts").textContent = h.external_script_count || "0";
      document.getElementById("inline-scripts").textContent = h.inline_script_count || "0";
      document.getElementById("unlabeled-buttons").textContent = h.a11y_unlabeled_buttons || "0";
      document.getElementById("unlabeled-links").textContent = h.a11y_unlabeled_links || "0";
      document.getElementById("form-count").textContent = h.form_count || "0";
      document.getElementById("form-fields").textContent = h.form_fields || "0";
      document.getElementById("popup-count").textContent = h.popup_count || "0";

      // Structural
      const hh = document.getElementById("heading-hierarchy"); hh.innerHTML = "";
      if (h.heading_hierarchy?.length) {
        h.heading_hierarchy.forEach(t => {
          const div = document.createElement("div");
          div.className = "heading-item";
          div.textContent = t;
          hh.appendChild(div);
        });
      } else { hh.textContent = "No headings found"; }
      document.getElementById("main-present").textContent = h.main_present ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("cta-grouping").textContent = h.cta_grouping ? "‚úÖ Yes" : "‚ùå No";
      document.getElementById("cta-position").textContent = h.cta_position != null ? `#${h.cta_position + 1}` : "N/A";
      document.getElementById("modals-with-cta").textContent = h.modals_with_cta ? "‚úÖ Yes" : "‚ùå No";

      // AI details section
      if (llm) {
        document.getElementById("summary").textContent = llm.summary || "‚Äî";
        // Scores
        const scoresGrid = document.getElementById("category-scores"); scoresGrid.innerHTML = "";
        Object.entries(llm.category_scores || {}).forEach(([k, v]) => {
          const card = document.createElement("div");
          card.className = "score-card";
          const cls = v >= 7 ? "good" : v >= 4 ? "medium" : "poor";
          card.innerHTML = `<div class="score-label">${k}</div><div class="score-value ${cls}">${v}/10</div>`;
          scoresGrid.appendChild(card);
        });
        // Issues/Wins/Actions
        const tI = document.getElementById("top-issues"); tI.innerHTML = "";
        (llm.top_issues || []).forEach(i => { const li = document.createElement("li"); li.textContent = i; tI.appendChild(li); });
        const qW = document.getElementById("quick-wins"); qW.innerHTML = "";
        (llm.quick_wins || []).forEach(i => { const li = document.createElement("li"); li.textContent = i; qW.appendChild(li); });
        
        // Detailed strengths
        const detailedStrengthsEl = document.getElementById("detailed-strengths");
        detailedStrengthsEl.innerHTML = "";
        strengths.forEach(s => { 
          const li = document.createElement('li'); 
          li.textContent = s; 
          li.style.borderLeftColor = 'var(--good)';
          li.style.borderLeftWidth = '3px';
          detailedStrengthsEl.appendChild(li); 
        });
        const act = document.getElementById("prioritized-actions"); act.innerHTML = "";
        (llm.prioritized_actions || []).forEach(a => {
          const div = document.createElement("div");
          const impact = a.impact ?? 2, effort = a.effort ?? 2, conf = a.confidence ?? 2;
          div.className = "action-item";
          div.innerHTML = `
            <h4>${a.action || "Action"}</h4>
            <p><strong>Why:</strong> ${a.why || "‚Äî"}</p>
            <div class="action-metrics">
              <span class="metric impact ${impact>=3?'high':impact>=2?'medium':'low'}">Impact: ${impact}/3</span>
              <span class="metric effort ${effort<=1?'easy':effort<=2?'medium':'hard'}">Effort: ${effort}/3</span>
              <span class="metric confidence">Confidence: ${conf}/3</span>
            </div>`;
          act.appendChild(div);
        });
        // Copy suggestions
        const cs = llm.copy_suggestions || [];
        const copyWrap = document.getElementById("copy-suggestions");
        const copyContent = document.getElementById("copy-content");
        if (cs.length) {
          copyWrap.style.display = "block";
          copyContent.innerHTML = "";
          cs.forEach(s => {
            const c = document.createElement("div");
            c.className = "copy-suggestion";
            c.innerHTML = `<h4>${s.area || 'General'}</h4><p>${s.text || ''}</p>`;
            copyContent.appendChild(c);
          });
        } else { copyWrap.style.display = "none"; }
      } else {
        document.getElementById("summary").textContent = "LLM analysis not available";
        
        // Still show strengths even without LLM
        const detailedStrengthsEl = document.getElementById("detailed-strengths");
        detailedStrengthsEl.innerHTML = "";
        strengths.forEach(s => { 
          const li = document.createElement('li'); 
          li.textContent = s; 
          li.style.borderLeftColor = 'var(--good)';
          li.style.borderLeftWidth = '3px';
          detailedStrengthsEl.appendChild(li); 
        });
      }
    }
  </script>
</body>
</html>